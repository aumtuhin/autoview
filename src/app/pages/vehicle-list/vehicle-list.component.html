<h2>Welches Auto m√∂chten Sie fahren?</h2>

<!--Show loading spinner while fetching data -->
<!-- <p-progressSpinner *ngIf="isLoading"></p-progressSpinner> -->

<!--Show vehicle list once data is loaded -->
<div *ngIf="!isLoading && !errorMessage">
  <button (click)="toggleSortOrder()">
    Sort {{ sortOrder === "asc" ? "Z-A" : "A-Z" }}
  </button>
</div>

<!--Skeleton Loader Before Data Loads -->
<div class="vehicle-list" *ngIf="isLoading">
  <div class="vehicle-card-container" *ngFor="let _ of [1, 2, 3, 4]">
    <p-card class="vehicle-card">
      <ng-template pTemplate="header">
        <p-skeleton width="100%" height="60px" borderRadius="8px"></p-skeleton>
      </ng-template>

      <div class="vehicle-info">
        <p-skeleton width="80%" height="20px"></p-skeleton>
        <p-skeleton width="60%" height="20px"></p-skeleton>
        <p-skeleton width="70%" height="20px"></p-skeleton>
      </div>

      <ng-template pTemplate="footer">
        <p-skeleton width="120px" height="40px" borderRadius="4px"></p-skeleton>
      </ng-template>
    </p-card>
  </div>
</div>

<!-- ‚úÖ Show Error Message If Data Fetch Fails -->
<div class="error-container" *ngIf="errorMessage && isError">
  <p-message severity="error" [text]="errorMessage"></p-message>
  <button pButton label="Retry" icon="pi pi-refresh" class="retry-button" (click)="loadVehicles()"></button>
</div>

<!-- ‚úÖ Show No Vehicles Message -->
<div class="error-container" *ngIf="!isLoading && vehicles.length === 0 && !errorMessage">
  <p-message severity="info" text="üöó No vehicles available at the moment."></p-message>
</div>

<div class="vehicle-list" *ngIf="vehicles.length > 0">
  <app-vehicle-card
    *ngFor="let vehicle of vehicles"
    [name]="vehicle.name"
    [manufacturer]="vehicle.manufacturer"
    [model]="vehicle.model"
    [mileage]="vehicle.mileage">
  </app-vehicle-card>
</div>

<!-- PrimeNG Dialog for Adding a Vehicle -->
<p-dialog
  [(visible)]="displayDialog"
  header="Add Vehicle"
  [modal]="true"
  [closable]="false"
>
  <div class="p-fluid">
    <label for="name">Name</label>
    <input pInputText id="name" [(ngModel)]="newVehicle.name" required />

    <label for="manufacturer">Manufacturer</label>
    <input
      pInputText
      id="manufacturer"
      [(ngModel)]="newVehicle.manufacturer"
      required
    />

    <label for="model">Model</label>
    <input pInputText id="model" [(ngModel)]="newVehicle.model" required />
  </div>

  <ng-template pTemplate="footer">
    <button
      pButton
      label="Cancel"
      icon="pi pi-times"
      class="p-button-text"
      (click)="closeDialog()"
    ></button>
    <button
      pButton
      label="Save"
      icon="pi pi-check"
      (click)="saveVehicle()"
      [disabled]="
        !newVehicle.name || !newVehicle.manufacturer || !newVehicle.model
      "
    ></button>
  </ng-template>
</p-dialog>
