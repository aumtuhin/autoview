<h2>Welches Auto m√∂chten Sie fahren?</h2>

<!--Show vehicle list once data is loaded -->
<div *ngIf="!isLoading && !errorMessage">
  <button (click)="toggleSortOrder()">
    Sort {{ sortOrder === "asc" ? "Z-A" : "A-Z" }}
  </button>
</div>

<!--Skeleton Loader Before Data Loads -->
<div class="vehicle-list" *ngIf="isLoading">
  <div class="vehicle-card-container" *ngFor="let _ of [1, 2, 3, 4]">
    <p-card class="vehicle-card">
      <ng-template pTemplate="header">
        <p-skeleton width="100%" height="60px" borderRadius="8px"></p-skeleton>
      </ng-template>

      <div class="vehicle-info">
        <p-skeleton width="80%" height="20px"></p-skeleton>
        <p-skeleton width="60%" height="20px"></p-skeleton>
        <p-skeleton width="70%" height="20px"></p-skeleton>
      </div>

      <ng-template pTemplate="footer">
        <p-skeleton width="120px" height="40px" borderRadius="4px"></p-skeleton>
      </ng-template>
    </p-card>
  </div>
</div>

<!-- ‚úÖ Show Error Message If Data Fetch Fails -->
<div class="error-container" *ngIf="errorMessage && isError">
  <p-message severity="error" [text]="errorMessage"></p-message>
  <button pButton label="Retry" icon="pi pi-refresh" class="retry-button" (click)="loadVehicles()"></button>
</div>

<!-- ‚úÖ Show No Vehicles Message -->
<div class="error-container" *ngIf="!isLoading && vehicles.length === 0 && !errorMessage">
  <p-message severity="info" text="üöó No vehicles available at the moment."></p-message>
</div>

<div class="vehicle-list" *ngIf="vehicles.length > 0">
  <app-vehicle-card
    *ngFor="let vehicle of vehicles"
    [name]="vehicle.name"
    [manufacturer]="vehicle.manufacturer"
    [model]="vehicle.model"
    [mileage]="vehicle.mileage">
  </app-vehicle-card>
</div>

<!-- Show Add Vehicle Dialog with Larger Width -->
<p-dialog [(visible)]="displayDialog" [modal]="true" [closable]="false" [style]="{ width: '500px' }">
  <div class="dialog-content">

    <h2 class="dialog-header">Add New Vehicle</h2>
    <label for="name">Vehicle Name:</label>
    <small class="error-label" *ngIf="errors.name">{{ errors.name }}</small>
    <input id="name" type="text" pInputText [(ngModel)]="newVehicle.name" required />

    <label for="manufacturer">Manufacturer:</label>
    <small class="error-label" *ngIf="errors.manufacturer">{{ errors.manufacturer }}</small>
    <input id="manufacturer" type="text" pInputText [(ngModel)]="newVehicle.manufacturer" required />

    <label for="model">Model:</label>
    <small class="error-label" *ngIf="errors.model">{{ errors.model }}</small>
    <input id="model" type="text" pInputText [(ngModel)]="newVehicle.model" required />

    <label for="mileage">Mileage:</label>
    <input id="mileage" type="number" pInputText [(ngModel)]="newVehicle.mileage" required />
  </div>

  <ng-template pTemplate="footer">
    <button pButton label="Cancel" class="p-button-text" (click)="closeDialog()"></button>
    <button pButton label="Save" class="p-button-primary" (click)="addVehicle()"></button>
  </ng-template>
</p-dialog>
